<!DOCTYPE html>
<!--suppress ALL -->
<html>

<head>

    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>User Disabler</title>
</head>

<body>

    <div id="dhis-header-bar"></div>

    <!-- Inactive User Job Status Section -->
    <div id="inactive-user-job-section" class="job-section" style="margin-bottom: 20px; background: #f8f8f8; border-bottom: 1px solid #ddd; padding: 16px 12px 8px 12px;">
        <div id="job-status-content">
            <!-- Filled dynamically by JS -->
        </div>
    </div>

    <div class="mainView container-fluid px-4">
        <form class="row g-3 align-items-end bg-light border rounded-3 p-3 mb-3" id="userFilterForm" autocomplete="off">
            <div class="col-auto">
                <label for="periodType" class="form-label mb-0">Period inactive</label>
                <select id="periodType" class="form-select form-select-sm">
                    <option value="months">Months</option>
                    <option value="years">Years</option>
                    <option value="date">Since date</option>
                </select>
            </div>
            <div class="col-auto">
                <label for="numPeriods" class="form-label mb-0">&nbsp;</label>
                <input type="number" id="numPeriods" min="1" value="6" class="form-control form-control-sm">
            </div>
            <div class="col-auto">
                <label for="specificDate" class="form-label mb-0">&nbsp;</label>
                <input type="date" id="specificDate" class="form-control form-control-sm" style="display: none;">
            </div>
            <div class="col-auto">
                                <label for="userRoleFilter" class="form-label mb-0">User Role</label>
                                <div class="w-100" style="max-width:900px;">
                                    <select id="userRoleFilter" multiple class="form-select form-select-sm w-100" style="min-width:400px;max-width:900px"></select>
                                </div>
            </div>
            <div class="col-auto">
                                <label for="userGroupFilter" class="form-label mb-0">User Group</label>
                                <div class="w-100" style="max-width:900px;">
                                    <select id="userGroupFilter" multiple class="form-select form-select-sm w-100" style="min-width:400px;max-width:900px"></select>
                                </div>
            </div>
            <div class="w-100"></div>
            <div class="col-auto">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="includeNeverLoggedIn">
                    <label class="form-check-label" for="includeNeverLoggedIn">Include users who never logged in</label>
                </div>
            </div>
            <div class="col-auto">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="includeDisabledUsers">
                    <label class="form-check-label" for="includeDisabledUsers">Include already disabled users</label>
                </div>
            </div>
            <div class="col-auto">
                <button id="applyFilterBtn" class="btn btn-primary btn-sm">Apply Filter</button>
            </div>
        </form>

    <table id="usersTable" class="table table-sm table-bordered table-hover align-middle">
            <thead>
                <tr>
                    <th><input type="checkbox" id="select-all"></th>
                    <th>Username</th>
                    <th>First Name</th>
                    <th>Surname</th>
                    <th>Disabled</th>
                    <th>Created</th>
                    <th>Last Login</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Filled dynamically by JS -->
            </tbody>
        </table>

        <!-- Modal for creating a new DISABLE_INACTIVE_USERS job -->
        <div id="createJobModal" class="modal">
            <div class="modal-content">
                <span class="close-create-job">&times;</span>
                <h3>Create Disable Inactive Users Job</h3>
                <form id="createJobForm">
                    <label for="jobName">Name:</label>
                    <input type="text" id="jobName" name="jobName" value="Disable inactive users" required><br>
                    <label for="inactiveMonths">Inactive Months:</label>
                    <input type="number" id="inactiveMonths" name="inactiveMonths" value="6" min="1" required><br>
                    <label for="reminderDaysBefore">Reminder Days Before:</label>
                    <input type="number" id="reminderDaysBefore" name="reminderDaysBefore" value="7" min="0" required><br>
                    <label for="cronExpression">Cron Expression:</label>
                    <input type="text" id="cronExpression" name="cronExpression" value="0 0 20 ? * *" required><br>
                    <button type="submit" class="dhis2-button blue">Create Job</button>
                </form>
            </div>
        </div>
        
        <button id="bulkDisableBtn" class="dhis2-button red">Bulk Disable</button>
        <div id="user-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="userInfo">
                    <!-- Filled dynamically by JS -->
                </div>
            </div>
        </div>

        <div id="summaryModal" class="modal">
            <div class="modal-content">
                <span class="close-summary">&times;</span>
                <div id="summaryContent">
                    <!-- Filled dynamically by JS -->
                </div>
                <button id="closeSummaryBtn">Close</button>
            </div>
        </div>

        <!-- Confirmation modal for bulk disabling -->
        <div id="confirmationModal" class="modal">
            <div class="modal-content">
                <span class="close-confirm">&times;</span>
                <div id="confirmationContent">
                    <!-- Confirmation info will be displayed here -->
                </div>
                <button id="confirmBulkDisableBtn" class="dhis2-button red">Confirm</button>
                <button id="cancelBulkDisableBtn" class="dhis2-button">Cancel</button>
            </div>
        </div>

        <!-- Progress modal for showing status updates during bulk operations -->
        <div id="progressModal" class="modal">
            <div class="modal-content">
                <span class="close-progress">&times;</span>
                <div id="progressContent">
                    <!-- Progress updates will be displayed here -->
                </div>
                <button id="closeProgressBtn" class="dhis2-button">Close</button>
            </div>
        </div>

        <div id="singleUserModal" class="modal">
            <div class="modal-content">
                <span class="close-single-user">&times;</span>
                <div id="singleUserModalContent">
                    <!-- Success/Error message will be displayed here -->
                </div>
            </div>
        </div>

    </div>
</body>

</html>